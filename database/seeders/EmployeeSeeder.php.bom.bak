<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Employee;
use App\Models\Department;
use App\Models\Filiale;
use App\Models\Agence;

class EmployeeSeeder extends Seeder
{
    public function run(): void
    {
        // Exemple : rÃ©cupÃ©rons un dÃ©partement pour associer les employÃ©s
        $department = Department::first() ?? Department::create(['name' => 'GÃ©nÃ©ral']);

        // RÃ©cupÃ©rons une filiale et une agence existante
        $filiale = Filiale::first();
        $agence  = Agence::first();

        // 1) EmployÃ© HillHolding (pas de filiale, pas dâ€™agence)
        Employee::updateOrCreate(
            ['email' => 'alice@hillholding.com'],
            [
                'first_name'    => 'Alice',
                'last_name'     => 'Niyonzima',
                'department_id' => $department->id,
                'filiale_id'    => null,
                'agency_id'     => null,
            ]
        );

        // 2) EmployÃ© Filiale (liÃ© uniquement Ã  une filiale)
        if ($filiale) {
            Employee::updateOrCreate(
                ['email' => 'jean@' . strtolower($filiale->name) . '.com'],
                [
                    'first_name'    => 'Jean',
                    'last_name'     => 'Habonimana',
                    'department_id' => $department->id,
                    'filiale_id'    => $filiale->id,
                    'agency_id'     => null,
                ]
            );
        }

        // 3) EmployÃ© Agence (liÃ© Ã  une filiale ET une agence)
        if ($filiale && $agence) {
            Employee::updateOrCreate(
                ['email' => 'eric@' . strtolower($agence->name) . '.com'],
                [
                    'first_name'    => 'Eric',
                    'last_name'     => 'Hakizimana',
                    'department_id' => $department->id,
                    'filiale_id'    => $filiale->id,
                    'agency_id'     => $agence->id,
                ]
            );
        }

        $this->command->info('ðŸ‘¥ EmployÃ©s de test crÃ©Ã©s avec succÃ¨s.');
    }
}







