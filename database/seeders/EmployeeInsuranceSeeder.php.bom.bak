<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\EmployeeInsurance;
use Illuminate\Support\Carbon;
use Illuminate\Support\Facades\DB;

class EmployeeInsuranceSeeder extends Seeder
{
    public function run(): void
    {
        // Supprime les anciennes donnÃ©es
        DB::table('employee_insurances')->truncate();

        $employeeInsurances = [
            [
                'employee_id' => 1,
                'insurance_plan_id' => 1,
                'insurance_provider' => 'AXA',
                'policy_number' => 'AXA-001', // <-- obligatoire
                'start_date' => Carbon::parse('2025-08-12'),
                'end_date' => Carbon::parse('2026-08-12'),
                'created_at' => now(),
                'updated_at' => now(),
            ],
            [
                'employee_id' => 2,
                'insurance_plan_id' => 2,
                'insurance_provider' => 'Allianz',
                'policy_number' => 'ALL-002', // <-- obligatoire
                'start_date' => Carbon::parse('2025-09-01'),
                'end_date' => Carbon::parse('2026-09-01'),
                'created_at' => now(),
                'updated_at' => now(),
            ],
        ];

        foreach ($employeeInsurances as $insurance) {
            EmployeeInsurance::create($insurance);
        }

        $this->command->info('âœ… Employee insurances seeded successfully!');
    }
}







